# RAWDOG Environment Variables Documentation
**Generated**: 2025-02-10
**Purpose**: Complete environment variable reference for multi-tenant migration

---

## Source Codebase Path

**RAWDOG Root**: `/Users/holdenthemic/Documents/rawdog-web/`
**Env File**: `/Users/holdenthemic/Documents/rawdog-web/.env.local` (local dev)
**Env Example**: `/Users/holdenthemic/Documents/rawdog-web/.env.example`

---

## Current Environment Variables

### Core Infrastructure

| Variable | Required | Description | Multi-Tenant Notes |
|----------|----------|-------------|-------------------|
| `POSTGRES_URL` | Yes | Neon PostgreSQL connection | Platform-wide, tenant schemas |
| `POSTGRES_URL_NON_POOLING` | No | Non-pooled connection for migrations | Platform-wide |
| `UPSTASH_REDIS_REST_URL` | Yes | Upstash Redis REST URL | Platform-wide |
| `UPSTASH_REDIS_REST_TOKEN` | Yes | Upstash Redis REST token | Platform-wide |
| `VERCEL_URL` | Auto | Vercel deployment URL | Per-tenant subdomains |
| `NODE_ENV` | Auto | Environment (development/production) | Platform-wide |

### Authentication (Clerk → Custom)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` | Yes* | Clerk publishable key | Replace with custom |
| `CLERK_SECRET_KEY` | Yes* | Clerk secret key | Replace with custom |
| `NEXT_PUBLIC_CLERK_SIGN_IN_URL` | No | Custom sign-in URL | Custom auth |
| `NEXT_PUBLIC_CLERK_SIGN_UP_URL` | No | Custom sign-up URL | Custom auth |
| `DEBUG_BYPASS_AUTH` | No | Local auth bypass | Keep pattern |
| `NEXT_PUBLIC_DEBUG_MODE` | No | Client debug mode | Keep pattern |

*Will be replaced with custom JWT auth in new platform

### Shopify Integration

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `SHOPIFY_STORE_DOMAIN` | Yes* | Store domain | Per-tenant (OAuth) |
| `NEXT_PUBLIC_SHOPIFY_STORE_DOMAIN` | Yes* | Public store domain | Per-tenant (OAuth) |
| `SHOPIFY_ADMIN_ACCESS_TOKEN` | Yes* | Admin API token | Per-tenant (OAuth) |
| `SHOPIFY_ADMIN_API_SECRET` | Yes* | API secret for webhooks | Per-tenant (OAuth) |
| `SHOPIFY_WEBHOOK_SECRET` | Yes* | Webhook signature secret | Per-tenant (OAuth) |
| `NEXT_PUBLIC_SHOPIFY_STOREFRONT_ACCESS_TOKEN` | No | Storefront API token | Per-tenant (OAuth) |

*Store in database for multi-tenant, use OAuth flow

### Stripe Payments

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `STRIPE_SECRET_KEY` | Yes | Stripe secret key | Platform-wide |
| `STRIPE_PUBLISHABLE_KEY` | Yes | Stripe publishable key | Platform-wide |
| `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY` | Yes | Client-side Stripe key | Platform-wide |
| `STRIPE_WEBHOOK_SECRET` | Yes | Webhook signature secret | Platform-wide |

### Meta (Facebook) Ads

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `META_PIXEL_ID` | No | Meta Pixel ID | Per-tenant (database) |
| `NEXT_PUBLIC_META_PIXEL_ID` | No | Client-side Pixel ID | Per-tenant (database) |
| `META_CAPI_ACCESS_TOKEN` | No | Conversions API token | Per-tenant (OAuth) |
| `META_SYSTEM_USER_TOKEN` | No | System user token | Per-tenant (OAuth) |
| `META_APP_ID` | No | Meta App ID | Platform-wide |
| `META_APP_SECRET` | No | Meta App secret | Platform-wide |

### Google Analytics 4

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `NEXT_PUBLIC_GA4_MEASUREMENT_ID` | No | GA4 Measurement ID | Per-tenant (config) |
| `GA4_API_SECRET` | No | Measurement Protocol secret | Per-tenant (config) |

### Google Ads

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `GOOGLE_ADS_CLIENT_ID` | No | OAuth client ID | Platform-wide |
| `GOOGLE_ADS_CLIENT_SECRET` | No | OAuth client secret | Platform-wide |
| `GOOGLE_ADS_DEVELOPER_TOKEN` | No | Developer token | Platform-wide |
| `GOOGLE_ADS_REFRESH_TOKEN` | No | Refresh token | Per-tenant (OAuth) |
| `GOOGLE_ADS_CUSTOMER_ID` | No | Customer ID | Per-tenant (OAuth) |
| `GOOGLE_ADS_MANAGER_ID` | No | Manager account ID | Per-tenant (OAuth) |

### TikTok Ads

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `TIKTOK_PIXEL_ID` | No | TikTok Pixel ID | Per-tenant (database) |
| `NEXT_PUBLIC_TIKTOK_PIXEL_ID` | No | Client-side Pixel ID | Per-tenant (database) |
| `TIKTOK_EVENTS_API_ACCESS_TOKEN` | No | Events API token | Per-tenant (OAuth) |
| `TIKTOK_APP_ID` | No | App ID | Platform-wide |
| `TIKTOK_APP_SECRET` | No | App secret | Platform-wide |

### Email (Resend)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `RESEND_API_KEY` | Yes | Resend API key (sending) | Per-tenant option |
| `RESEND_FULL_ACCESS_API_KEY` | No | Full access key (debugging) | Platform-wide |
| `RESEND_DOMAIN` | No | Sending domain | Per-tenant |

### Voice/SMS (Retell)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `RETELL_API_KEY` | No | Retell API key | Per-tenant option |
| `RETELL_AGENT_ID` | No | Default agent ID | Per-tenant |
| `RETELL_SMS_PHONE_NUMBER` | No | SMS phone number | Per-tenant |

### Video (Mux)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `MUX_TOKEN_ID` | No | Mux token ID | Per-tenant option |
| `MUX_TOKEN_SECRET` | No | Mux token secret | Per-tenant option |
| `MUX_WEBHOOK_SECRET` | No | Webhook secret | Per-tenant option |

### Transcription (AssemblyAI)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `ASSEMBLYAI_API_KEY` | No | AssemblyAI API key | Platform-wide |

### Marketing (Klaviyo)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `KLAVIYO_PRIVATE_API_KEY` | No | Private API key | Per-tenant (database) |
| `NEXT_PUBLIC_KLAVIYO_PUBLIC_API_KEY` | No | Public API key | Per-tenant (database) |
| `KLAVIYO_SMS_LIST_ID` | No | SMS list ID | Per-tenant (database) |
| `KLAVIYO_EMAIL_LIST_ID` | No | Email list ID | Per-tenant (database) |

### Reviews (Yotpo)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `YOTPO_APP_KEY` | No | Yotpo App key | Per-tenant (database) |
| `NEXT_PUBLIC_YOTPO_APP_KEY` | No | Client-side App key | Per-tenant (database) |
| `YOTPO_API_SECRET` | No | API secret | Per-tenant (database) |

### Slack

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `SLACK_BOT_TOKEN` | No | Bot token (xoxb-) | Per-tenant option |
| `SLACK_SIGNING_SECRET` | No | Request signing secret | Per-tenant option |
| `SLACK_WEBHOOK_URL` | No | Webhook URL | Per-tenant option |
| `SLACK_APP_ID` | No | App ID | Platform-wide |
| `SLACK_CLIENT_ID` | No | OAuth client ID | Platform-wide |
| `SLACK_CLIENT_SECRET` | No | OAuth client secret | Platform-wide |

### Google Workspace

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `GOOGLE_CLIENT_ID` | No | OAuth client ID | Platform-wide |
| `GOOGLE_CLIENT_SECRET` | No | OAuth client secret | Platform-wide |
| `GOOGLE_REDIRECT_URI` | No | OAuth redirect URI | Platform-wide |

### Background Jobs (Trigger.dev → Inngest)

| Variable | Required | Description | Notes |
|----------|----------|-------------|-------|
| `TRIGGER_API_KEY` | Yes* | Trigger.dev API key | Replace with Inngest |
| `TRIGGER_API_URL` | Yes* | Trigger.dev API URL | Replace with Inngest |
| `INNGEST_EVENT_KEY` | Yes | Inngest event key | New platform |
| `INNGEST_SIGNING_KEY` | Yes | Inngest signing key | New platform |

### AI Services

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `ANTHROPIC_API_KEY` | No | Anthropic API key | Platform-wide |
| `OPENAI_API_KEY` | No | OpenAI API key | Platform-wide |

### Fairing (Surveys)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `FAIRING_API_KEY` | No | Fairing API key | Per-tenant option |

### ElevenLabs (TTS)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `ELEVENLABS_API_KEY` | No | ElevenLabs API key | Per-tenant option |

### Lob (Physical Mail)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `LOB_API_KEY` | No | Lob API key | Per-tenant option |
| `LOB_WEBHOOK_SECRET` | No | Webhook signature secret | Per-tenant option |

### Plaid (Bank Verification)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `PLAID_CLIENT_ID` | No | Plaid client ID | Per-tenant option |
| `PLAID_SECRET` | No | Plaid secret key | Per-tenant option |
| `PLAID_ENV` | No | Environment (sandbox/development/production) | Per-tenant |

### PayPal (Payouts)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `PAYPAL_CLIENT_ID` | No | PayPal client ID | Per-tenant option |
| `PAYPAL_CLIENT_SECRET` | No | PayPal client secret | Per-tenant option |
| `PAYPAL_MODE` | No | Mode (sandbox/live) | Per-tenant |
| `PAYPAL_WEBHOOK_ID` | No | Webhook ID for verification | Per-tenant |

### Microsoft Clarity (Analytics)

| Variable | Required | Description | OAuth Possible? |
|----------|----------|-------------|-----------------|
| `NEXT_PUBLIC_CLARITY_PROJECT_ID` | No | Clarity project ID | Per-tenant option |

### Better Stack (Uptime Monitoring)

| Variable | Required | Description | Notes |
|----------|----------|-------------|-------|
| `BETTER_STACK_API_KEY` | No | Better Stack API key | Platform-wide |
| `BETTER_STACK_WEBHOOK_SECRET` | No | Webhook signature secret | Platform-wide |

### Sentry (Error Tracking)

| Variable | Required | Description | Notes |
|----------|----------|-------------|-------|
| `NEXT_PUBLIC_SENTRY_DSN` | No | Sentry DSN | Platform-wide |
| `SENTRY_AUTH_TOKEN` | No | Auth token for releases | Platform-wide |
| `SENTRY_ORG` | No | Sentry organization slug | Platform-wide |
| `SENTRY_PROJECT` | No | Sentry project name | Platform-wide |

### Encryption

| Variable | Required | Description | Notes |
|----------|----------|-------------|-------|
| `ENCRYPTION_KEY` | Yes | 32-byte encryption key | Platform-wide |

### Feature Flags / A/B Testing

| Variable | Required | Description | Notes |
|----------|----------|-------------|-------|
| `AB_TESTING_ENABLED` | No | Enable A/B testing | Per-tenant option |

---

## Multi-Tenant Storage Strategy

### Platform-Wide (Environment Variables)
These remain as environment variables:
- Database connection strings
- Redis connection
- Platform OAuth app credentials (Meta App, Google Cloud, TikTok App)
- AI service API keys
- Encryption keys

### Per-Tenant (Database Storage)
These move to encrypted database storage:
- Shopify credentials (OAuth tokens)
- Stripe Connect account IDs
- Meta Ads credentials (per ad account)
- Google Ads credentials (per customer)
- TikTok Ads credentials
- Klaviyo credentials
- Yotpo credentials
- Slack workspace tokens
- GA4 configuration
- Custom domain settings
- Plaid credentials (bank verification)
- PayPal OAuth tokens
- ElevenLabs API keys
- Lob API keys
- Fairing API keys
- Microsoft Clarity project IDs

### Tenant Configuration Table
```sql
CREATE TABLE tenant_credentials (
  id UUID PRIMARY KEY,
  tenant_id TEXT REFERENCES tenants(id),
  provider TEXT, -- 'shopify', 'stripe', 'meta', etc.
  credential_type TEXT, -- 'oauth_token', 'api_key', 'config'
  encrypted_value TEXT, -- AES-256 encrypted
  metadata JSONB, -- Non-sensitive metadata
  expires_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(tenant_id, provider, credential_type)
);
```

---

## Environment Variable Migration Plan

### Phase 1: Core Infrastructure
1. Keep database/Redis env vars
2. Set up encryption key
3. Configure Inngest credentials

### Phase 2: OAuth Migration
1. Store Shopify credentials in database
2. Migrate Meta/Google/TikTok to OAuth flows
3. Keep platform OAuth app credentials in env

### Phase 3: Per-Tenant Services
1. Move Klaviyo/Yotpo to database
2. Configure per-tenant email domains
3. Set up per-tenant Slack workspaces

---

## New Platform Environment Variables

### Platform Core
```bash
# Database
POSTGRES_URL=
POSTGRES_URL_NON_POOLING=

# Redis
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# Encryption
ENCRYPTION_KEY=

# Platform URL
NEXT_PUBLIC_PLATFORM_URL=https://platform.example.com
```

### Authentication (Custom)
```bash
# JWT
JWT_SECRET=
JWT_EXPIRES_IN=7d

# Session
SESSION_SECRET=
SESSION_COOKIE_NAME=platform_session
```

### Background Jobs (Inngest)
```bash
INNGEST_EVENT_KEY=
INNGEST_SIGNING_KEY=
```

### OAuth Apps (Platform-Wide)
```bash
# Shopify App
SHOPIFY_APP_ID=
SHOPIFY_APP_SECRET=
SHOPIFY_APP_SCOPES=

# Meta App
META_APP_ID=
META_APP_SECRET=

# Google Cloud
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# TikTok App
TIKTOK_APP_ID=
TIKTOK_APP_SECRET=

# Slack App
SLACK_APP_ID=
SLACK_CLIENT_ID=
SLACK_CLIENT_SECRET=
```

### AI Services
```bash
ANTHROPIC_API_KEY=
OPENAI_API_KEY=
```

### Email (Platform Default)
```bash
RESEND_API_KEY=
RESEND_DOMAIN=platform.example.com
```

### Monitoring
```bash
SENTRY_DSN=
VERCEL_ANALYTICS_ID=
```
